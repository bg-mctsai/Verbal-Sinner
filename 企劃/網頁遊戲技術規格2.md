《嘴砲王者》網頁遊戲開發技術規格書 (Firebase & AI 整合版)

一、 遊戲概述 (Project Overview)

本遊戲是一款基於 AI 驅動的敘事冒險遊戲。玩家扮演一名現實生活中的失敗者，在重生系統中透過「對話博弈」來獲得 EQ 點數，最終目標是累積足夠點數以復活並改寫命運。

二、 系統架構圖 (System Architecture)

graph TD

    A[前端 React App] -->|1. 身份驗證| B[Firebase Auth]

    A -->|2. 讀取進度/存檔| C[Firestore DB]

    A -->|3. 玩家輸入| D[Gemini AI Engine]

    D -->|4. 語意分析/傷害計算| D

    D -->|5. 語音生成| E[Gemini TTS API]

    E -->|6. 音頻數據| A

    D -->|7. JSON 結果| A

    A -->|8. 更新狀態| C

三、 核心開發模組 (Core Modules)

1. 玩家身份與年齡選擇系統

機制： 進入遊戲後，強制進行年齡選擇。

資料綁定： 年齡決定了啟動哪一個「穿書劇本集」（如 36-50 歲開啟宮廷劇本）。

Firebase 存儲：users/{uid}/profile/age_category。

2. AI 語意判斷核心 (AI Semantic Engine)

判斷邏輯： AI 不僅是生成對話，更需擔任「裁判」。

輸入參數：

Context: NPC 性格、當前場景背景、NPC 弱點關鍵字。

PlayerInput: 玩家輸入的文本。

History: 前 3 回合的對話記錄。

輸出結果 (JSON)： 包含 NPC 回覆、傷害數值、情緒標籤（生氣、慌張、哭泣）。

3. 語音與劇場反饋系統

聲音製作： 根據 AI 返回的文字，調用 TTS 生成帶有情緒的 WAV 檔。

視覺聯動：

立繪變換： 根據 emotion_tag 切換 NPC 表情。

特效觸發： 暴擊時（Damage > 50）觸發螢幕震動。

四、 Firebase 資料架構 (Database Schema)

1. 公共資料 (Public/Static)

Collection: stages

documentId: stage_id (e.g., age3_chap1_lv1)

fields:

bg_image: string (場景圖 URL)

opening_voice: string (旁白語音腳本)

npc_id: string (關聯 NPC)

Collection: npcs

documentId: npc_id

fields:

weakness_tags: array (核心弱點)

base_sanity: number (初始血量)

2. 使用者資料 (Private/User)

Collection: users

documentId: {userId}

Sub-collection: level_states

紀錄當前正在進行的關卡進度、對話歷史與剩餘血量。

五、 遊戲流程圖 (Game Flow)

sequenceDiagram

    participant P as 玩家 (React)

    participant F as Firebase (DB/Auth)

    participant A as Gemini AI

    participant T as TTS Engine

    P->>F: 登入並選擇年齡

    F-->>P: 返回初始劇本與旁白內容

    P->>P: 播放背景圖與旁白語音

    Note right of P: 進入對峙階段

    P->>A: 送出嘴砲內容 + NPC 弱點

    A->>A: 計算傷害與情緒轉變

    A-->>P: 返回 JSON (回覆文字 + 傷害 + 情緒標籤)

    P->>T: 請求回覆文字的語音

    T-->>P: 返回音訊串流

    P->>F: 更新 NPC 剩餘血量與玩家 EQ 點數

    P->>P: 更新 UI (血條減少、表情切換)

六、 視覺與音效規格 (Multimedia Specs)

1. 視覺資產 (Visuals)

場景圖： 1920x1080px。每個故事階段具備 3 種色彩變體（明亮、昏暗、崩潰紫）。

角色立繪： 透明 PNG。包含 Idle, Talking, Shocked, Crying 四種姿態。

2. 音效與配音 (Audio)

BGM： 循環播放。隨 NPC 血量降低，節奏加快。

語音： 採用 Gemini TTS。每位角色設定專屬聲音代碼。

七、 開發里程碑 (Milestones)

第一階段 (Foundation): 完成 Firebase Auth 與 Firestore 的讀寫權限設定。

第二階段 (AI Core): 完成 AI Prompt 模板測試，確保 JSON 輸出穩定。

第三階段 (Interface): 實作 React 動態對話視窗與情緒血條。

第四階段 (Assets): 導入 100 關卡的靜態數據與場景圖。

第五階段 (Polish): 整合語音生成與結算動畫。

八、 開發工具與環境 (Tech Stack & Tooling)

1. 前端開發 (Frontend)

框架:React.js (搭配 Vite 作為構建工具，提升開發速度)。

樣式:Tailwind CSS (快速實作響應式 UI 與自定義動畫)。

狀態管理:React Context API 或 Signals (處理遊戲全局點數與玩家狀態)。

動畫庫:Framer Motion (實作 NPC 立繪切換與傷害數字跳動效果)。

2. 後端與雲端服務 (Backend/BaaS)

平台:Firebase。

Authentication: 支援匿名登入或第三方社群登入 (Google)。

Cloud Firestore: NoSQL 即時資料庫，儲存所有遊戲數據。

Storage: 存放高品質場景圖、立繪與 BGM 音檔。

Hosting: 一鍵部署遊戲網頁。

3. 人工智慧引擎 (AI & Voice)

對話與邏輯判斷:gemini-2.5-flash-preview-09-2025 (處理語意、傷害計算與 JSON 生成)。

語音合成:gemini-2.5-flash-preview-tts (生成 NPC 與旁白的語音)。

4. 設計與協作 (Design & Workflow)

UI/UX 設計:Figma (規劃介面佈局與配色)。

流程圖繪製:Mermaid.js (用於規格書中的流程與架構圖)。

素材生成:Imagen-4.0 (用於生成關卡背景圖與角色初始草圖)。

版本控制:GitHub 或 GitLab。

「重生是你的權利，而嘴砲是你的武器。」

* 
* 
* Go to[ ] Page
